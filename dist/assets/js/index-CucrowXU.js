import{G as L,D as O,r as k,c as m,d as R,f as d,g as t,m as q,B as A,H as K,u as N,F as $,p as P,h as M,t as C,v as W,k as v,_ as V,C as G,w as J,o as j,e as E,s as Q}from"./index-CCChZRxu.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const F=()=>{};function U(s,a){function o(...e){return new Promise((l,n)=>{Promise.resolve(s(()=>a.apply(this,e),{fn:a,thisArg:this,args:e})).then(l).catch(n)})}return o}function z(s,a={}){let o,e,l=F;const n=g=>{clearTimeout(g),l(),l=F};let _;return g=>{const S=L(s),i=L(a.maxWait);return o&&n(o),S<=0||i!==void 0&&i<=0?(e&&(n(e),e=void 0),Promise.resolve(g())):new Promise((r,u)=>{l=a.rejectOnCancel?u:r,_=g,i&&!e&&(e=setTimeout(()=>{o&&n(o),e=void 0,r(_())},i)),o=setTimeout(()=>{e&&n(e),e=void 0,r(g())},S)})}}function X(s,a=200,o={}){return U(z(a,o),s)}const D=O("search",()=>{const s=k([]),a=k(["æ‰‹æœº","ç”µè„‘","è€³æœº","é”®ç›˜","è¡£æœ","é‹å­","åŒ…åŒ…","åŒ–å¦†å“","é£Ÿå“","é¥®æ–™","é›¶é£Ÿ","å¹³æ¿"]),o=k([]),e=k([]),l=k(""),n=k(!1),_=()=>{const c=localStorage.getItem("searchHistory");if(c)try{s.value=JSON.parse(c)}catch(h){console.error("è§£ææœç´¢å†å²å¤±è´¥:",h),s.value=[]}},w=c=>{if(!c.trim())return;const h=s.value.indexOf(c);h!==-1&&s.value.splice(h,1),s.value.unshift(c),s.value.length>10&&(s.value=s.value.slice(0,10)),localStorage.setItem("searchHistory",JSON.stringify(s.value))},g=c=>{s.value.splice(c,1),localStorage.setItem("searchHistory",JSON.stringify(s.value))},S=()=>{s.value=[],localStorage.removeItem("searchHistory")},i=c=>{const h=["æ‰‹æœº","ç”µè„‘","å¹³æ¿","è€³æœº","è¡£æœ","é‹å­","åŒ…åŒ…","é£Ÿå“","é¥®æ–™","é›¶é£Ÿ"];o.value=h.filter(x=>x.includes(c)).slice(0,5)},r=c=>{const h=[{id:1,name:"åä¸ºæ‰‹æœº",price:3999,image:"https://picsum.photos/200/150?random=1",category:"æ‰‹æœº"},{id:2,name:"è‹¹æœæ‰‹æœº",price:5999,image:"https://picsum.photos/200/150?random=2",category:"æ‰‹æœº"},{id:3,name:"å°ç±³æ‰‹æœº",price:1999,image:"https://picsum.photos/200/150?random=3",category:"æ‰‹æœº"},{id:4,name:"æ‰‹æœºå£³",price:49,image:"https://picsum.photos/200/150?random=4",category:"é…ä»¶"},{id:5,name:"æ‰‹æœºå……ç”µå™¨",price:99,image:"https://picsum.photos/200/150?random=5",category:"é…ä»¶"},{id:6,name:"ç¬”è®°æœ¬ç”µè„‘",price:7999,image:"https://picsum.photos/200/150?random=6",category:"ç”µè„‘"},{id:7,name:"å¹³æ¿ç”µè„‘",price:2999,image:"https://picsum.photos/200/150?random=7",category:"å¹³æ¿"},{id:8,name:"æ— çº¿è€³æœº",price:499,image:"https://picsum.photos/200/150?random=8",category:"è€³æœº"},{id:9,name:"ç”·å£«Tæ¤",price:99,image:"https://picsum.photos/200/150?random=9",category:"è¡£æœ"},{id:10,name:"è¿åŠ¨é‹",price:299,image:"https://picsum.photos/200/150?random=10",category:"é‹å­"}];if(!c.trim())return h;const x=c.toLowerCase();return h.filter(b=>b.name.toLowerCase().includes(x)||b.category.toLowerCase().includes(x))},u=async c=>{n.value=!0,l.value=c,await new Promise(h=>setTimeout(h,500));try{i(c);const h=r(c);e.value=h,c.trim()&&w(c)}catch(h){console.error("æœç´¢å¤±è´¥:",h),e.value=[]}finally{n.value=!1}},H=m(()=>s.value),f=m(()=>a.value),y=m(()=>o.value),p=m(()=>e.value),T=m(()=>l.value),B=m(()=>n.value);return{history:s,hotKeywords:a,suggestions:o,results:e,keyword:l,isLoading:n,getHistory:H,getHotKeywords:f,getSuggestions:y,getResults:p,getKeyword:T,getIsLoading:B,loadHistory:_,addToHistory:w,removeHistory:g,clearHistory:S,searchProducts:u}}),Y={class:"search-container"},Z={class:"search-box"},ee={key:0,class:"search-history"},te={class:"history-tags"},se=["onClick"],oe=["onClick"],re={key:1,class:"search-suggestions"},ae=["onClick"],ne=R({__name:"SearchBar",setup(s){const a=D(),o=k(""),e=k(!1),l=k(!1),n=X(()=>{if(!o.value.trim()){l.value=!1;return}a.addToHistory(o.value),a.searchProducts(o.value),l.value=!0},500),_=m(()=>a.history),w=m(()=>a.suggestions),g=f=>{o.value=f,a.searchProducts(f),e.value=!1},S=f=>{a.removeHistory(f)},i=()=>{a.clearHistory()},r=()=>{o.value="",e.value=!1,l.value=!1},u=()=>{setTimeout(()=>{e.value=!1},200)},H=f=>{o.value=f,n()};return(f,y)=>(v(),d("div",Y,[t("div",Z,[A(t("input",{"onUpdate:modelValue":y[0]||(y[0]=p=>o.value=p),type:"text",placeholder:"æœç´¢å•†å“...",onInput:y[1]||(y[1]=(...p)=>N(n)&&N(n)(...p)),onFocus:y[2]||(y[2]=p=>e.value=!0),onBlur:u},null,544),[[K,o.value]]),t("button",{onClick:r},"æ¸…ç©º")]),e.value&&_.value.length?(v(),d("div",ee,[t("div",{class:"history-header"},[y[3]||(y[3]=t("span",null,"æœç´¢å†å²",-1)),t("button",{onClick:i},"æ¸…ç©ºæ‰€æœ‰")]),t("div",te,[(v(!0),d($,null,P(_.value,(p,T)=>(v(),d("span",{key:T,class:"history-tag",onClick:B=>g(p)},[M(C(p)+" ",1),t("span",{class:"delete",onClick:W(B=>S(T),["stop"])},"Ã—",8,oe)],8,se))),128))])])):q("",!0),l.value&&w.value.length?(v(),d("div",re,[(v(!0),d($,null,P(w.value,p=>(v(),d("div",{key:p},[t("span",{onClick:T=>H(p)},C(p),9,ae)]))),128))])):q("",!0)]))}}),ie=V(ne,[["__scopeId","data-v-7d81c25e"]]);function I(s){return typeof s=="string"?s:Array.isArray(s)&&s.length>0?s[0]:""}const ce={class:"search-results-page"},le={class:"search-header"},ue={class:"results-content"},de={key:0,class:"loading-state"},ve={key:1,class:"no-results"},he={class:"suggestions"},pe={class:"hot-tags"},me=["onClick"],ge={key:2},ye={class:"results-header"},_e={class:"results-count"},fe={class:"product-list"},ke=["onClick"],we=["src","alt"],Se={class:"product-info"},Ce={class:"product-name"},He={class:"product-category"},Te={class:"product-price"},xe={key:3,class:"initial-state"},$e=R({__name:"index",setup(s){const a=G(),o=Q(),e=D(),l=m(()=>I(a.query.q)||e.keyword),n=m(()=>e.results),_=m(()=>e.isLoading),w=m(()=>e.hotKeywords);J(()=>a.query.q,i=>{const r=I(i);r.trim()&&e.searchProducts(r)},{immediate:!0});const g=i=>{o.push({path:"/search",query:{q:i}})},S=i=>{o.push(`/product/${i}`)};return j(()=>{const i=I(a.query.q);i&&e.searchProducts(i)}),(i,r)=>(v(),d("div",ce,[t("div",le,[E(ie)]),t("div",ue,[_.value?(v(),d("div",de,[...r[0]||(r[0]=[t("div",{class:"spinner"},null,-1),t("p",null,"æ­£åœ¨æœç´¢...",-1)])])):n.value.length===0&&l.value?(v(),d("div",ve,[r[2]||(r[2]=t("div",{class:"empty-icon"},"ğŸ”",-1)),t("h3",null,'æ²¡æœ‰æ‰¾åˆ°"'+C(l.value)+'"ç›¸å…³å•†å“',1),r[3]||(r[3]=t("p",null,"è¯·å°è¯•å…¶ä»–å…³é”®è¯",-1)),t("div",he,[r[1]||(r[1]=t("h4",null,"çƒ­é—¨æœç´¢ï¼š",-1)),t("div",pe,[(v(!0),d($,null,P(w.value,u=>(v(),d("span",{key:u,class:"hot-tag",onClick:H=>g(u)},C(u),9,me))),128))])])])):n.value.length>0?(v(),d("div",ge,[t("div",ye,[r[4]||(r[4]=t("h2",null,"æœç´¢ç»“æœ",-1)),t("p",_e,"æ‰¾åˆ° "+C(n.value.length)+" ä¸ªç›¸å…³å•†å“",1)]),t("div",fe,[(v(!0),d($,null,P(n.value,u=>(v(),d("div",{key:u.id,class:"product-card",onClick:H=>S(u.id)},[t("img",{src:u.image,alt:u.name,class:"product-image"},null,8,we),t("div",Se,[t("h3",Ce,C(u.name),1),t("p",He,C(u.category),1),t("div",Te,"Â¥"+C(u.price),1)])],8,ke))),128))])])):(v(),d("div",xe,[...r[5]||(r[5]=[t("div",{class:"placeholder-icon"},"ğŸ”",-1),t("p",null,"è¯·è¾“å…¥å…³é”®è¯æœç´¢å•†å“",-1)])]))])]))}}),Be=V($e,[["__scopeId","data-v-adae67dc"]]);export{Be as default};
