import{H as P,G as V,r as p,c as h,d as D,f,g as d,l as b,C as R,I as W,u as B,F,q as L,h as G,t as N,x as J,k as S,_ as M}from"./index-DvrrHcYe.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const O=()=>{};function j(s,a){function t(...e){return new Promise((i,r)=>{Promise.resolve(s(()=>a.apply(this,e),{fn:a,thisArg:this,args:e})).then(i).catch(r)})}return t}function A(s,a={}){let t,e,i=O;const r=u=>{clearTimeout(u),i(),i=O};let g;return u=>{const k=P(s),v=P(a.maxWait);return t&&r(t),k<=0||v!==void 0&&v<=0?(e&&(r(e),e=void 0),Promise.resolve(u())):new Promise((y,H)=>{i=a.rejectOnCancel?H:y,g=u,v&&!e&&(e=setTimeout(()=>{t&&r(t),e=void 0,y(g())},v)),t=setTimeout(()=>{e&&r(e),e=void 0,y(u())},k)})}}function $(s,a=200,t={}){return j(A(a,t),s)}const q=V("search",()=>{const s=p([]),a=p(["手机","电脑","耳机","键盘","衣服","鞋子","包包","化妆品","食品","饮料","零食","平板"]),t=p([]),e=p([]),i=p(""),r=p(!1),g=()=>{const o=localStorage.getItem("searchHistory");if(o)try{s.value=JSON.parse(o)}catch(n){console.error("解析搜索历史失败:",n),s.value=[]}},_=o=>{if(!o.trim())return;const n=s.value.indexOf(o);n!==-1&&s.value.splice(n,1),s.value.unshift(o),s.value.length>10&&(s.value=s.value.slice(0,10)),localStorage.setItem("searchHistory",JSON.stringify(s.value))},u=o=>{s.value.splice(o,1),localStorage.setItem("searchHistory",JSON.stringify(s.value))},k=()=>{s.value=[],localStorage.removeItem("searchHistory")},v=o=>{const n=["手机","电脑","平板","耳机","衣服","鞋子","包包","食品","饮料","零食"];t.value=n.filter(w=>w.includes(o)).slice(0,5)},y=o=>{const n=[{id:1,name:"华为手机",price:3999,image:"https://picsum.photos/200/150?random=1",category:"手机"},{id:2,name:"苹果手机",price:5999,image:"https://picsum.photos/200/150?random=2",category:"手机"},{id:3,name:"小米手机",price:1999,image:"https://picsum.photos/200/150?random=3",category:"手机"},{id:4,name:"手机壳",price:49,image:"https://picsum.photos/200/150?random=4",category:"配件"},{id:5,name:"手机充电器",price:99,image:"https://picsum.photos/200/150?random=5",category:"配件"},{id:6,name:"笔记本电脑",price:7999,image:"https://picsum.photos/200/150?random=6",category:"电脑"},{id:7,name:"平板电脑",price:2999,image:"https://picsum.photos/200/150?random=7",category:"平板"},{id:8,name:"无线耳机",price:499,image:"https://picsum.photos/200/150?random=8",category:"耳机"},{id:9,name:"男士T恤",price:99,image:"https://picsum.photos/200/150?random=9",category:"衣服"},{id:10,name:"运动鞋",price:299,image:"https://picsum.photos/200/150?random=10",category:"鞋子"}];if(!o.trim())return n;const w=o.toLowerCase();return n.filter(I=>I.name.toLowerCase().includes(w)||I.category.toLowerCase().includes(w))},H=async o=>{r.value=!0,i.value=o,await new Promise(n=>setTimeout(n,500));try{v(o);const n=y(o);e.value=n,o.trim()&&_(o)}catch(n){console.error("搜索失败:",n),e.value=[]}finally{r.value=!1}},T=h(()=>s.value),m=h(()=>a.value),l=h(()=>t.value),c=h(()=>e.value),C=h(()=>i.value),x=h(()=>r.value);return{history:s,hotKeywords:a,suggestions:t,results:e,keyword:i,isLoading:r,getHistory:T,getHotKeywords:m,getSuggestions:l,getResults:c,getKeyword:C,getIsLoading:x,loadHistory:g,addToHistory:_,removeHistory:u,clearHistory:k,searchProducts:H}}),E={class:"search-container"},U={class:"search-box"},z={key:0,class:"search-history"},Q={class:"history-tags"},X=["onClick"],Y=["onClick"],Z={key:1,class:"search-suggestions"},K=["onClick"],ee=D({__name:"SearchBar",setup(s){const a=q(),t=p(""),e=p(!1),i=p(!1),r=$(()=>{if(!t.value.trim()){i.value=!1;return}a.addToHistory(t.value),a.searchProducts(t.value),i.value=!0},500),g=h(()=>a.history),_=h(()=>a.suggestions),u=m=>{t.value=m,a.searchProducts(m),e.value=!1},k=m=>{a.removeHistory(m)},v=()=>{a.clearHistory()},y=()=>{t.value="",e.value=!1,i.value=!1},H=()=>{setTimeout(()=>{e.value=!1},200)},T=m=>{t.value=m,r()};return(m,l)=>(S(),f("div",E,[d("div",U,[R(d("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>t.value=c),type:"text",placeholder:"搜索商品...",onInput:l[1]||(l[1]=(...c)=>B(r)&&B(r)(...c)),onFocus:l[2]||(l[2]=c=>e.value=!0),onBlur:H},null,544),[[W,t.value]]),d("button",{onClick:y},"清空")]),e.value&&g.value.length?(S(),f("div",z,[d("div",{class:"history-header"},[l[3]||(l[3]=d("span",null,"搜索历史",-1)),d("button",{onClick:v},"清空所有")]),d("div",Q,[(S(!0),f(F,null,L(g.value,(c,C)=>(S(),f("span",{key:C,class:"history-tag",onClick:x=>u(c)},[G(N(c)+" ",1),d("span",{class:"delete",onClick:J(x=>k(C),["stop"])},"×",8,Y)],8,X))),128))])])):b("",!0),i.value&&_.value.length?(S(),f("div",Z,[(S(!0),f(F,null,L(_.value,c=>(S(),f("div",{key:c},[d("span",{onClick:C=>T(c)},N(c),9,K)]))),128))])):b("",!0)]))}}),se=M(ee,[["__scopeId","data-v-7d81c25e"]]);export{se as S,q as u};
