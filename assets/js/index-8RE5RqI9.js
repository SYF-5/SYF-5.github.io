import{d as x,c as d,C as K,r as T,w as $,o as b,f as n,e as v,h as s,i as B,t as c,F as y,j as k,s as F,q as N,g as a,_ as M}from"./index-DUXVB-iX.js";import{u as P,L as V,a as A,b as Q}from"./LayoutFooter-C7Ht1XwE.js";import{u as R}from"./cart-CMeJYCHv.js";import"./productService-DLGyYyOD.js";function m(r){return typeof r=="string"?r:Array.isArray(r)&&r.length>0?r[0]:""}const j={class:"results-content"},D={key:0,class:"loading-state"},E={key:1,class:"no-results"},H={class:"suggestions"},I={class:"hot-tags"},W=["onClick"],z={key:2},G={class:"results-header"},J={class:"results-count"},O={class:"product-list"},U=["onClick"],X=["src","alt"],Y={class:"product-info"},Z=["onClick"],ss={class:"product-desc"},ts={class:"product-price"},es=["onClick"],os={key:3,class:"initial-state"},ns={key:0,class:"success-message"},as=x({__name:"index",setup(r){const u=K(),_=N(),i=P(),w=R(),g=d(()=>m(u.query.q)||i.keyword),l=d(()=>i.results),C=d(()=>i.isLoading),q=d(()=>i.hotKeywords),h=T(!1);$(()=>u.query.q,o=>{const t=m(o);t.trim()&&i.searchProducts(t)},{immediate:!0});const S=o=>{_.push({path:"/search",query:{q:o}})},f=o=>{_.push(`/product/${o}`)},L=async o=>{try{const{quantity:t,...e}=o;await w.addToCart(e),h.value=!0,setTimeout(()=>{h.value=!1},3e3)}catch(t){const e=t;e.message==="è¯·å…ˆç™»å½•"?confirm("è¯·å…ˆç™»å½•ï¼Œç‚¹å‡»ç¡®å®šè·³è½¬åˆ°ç™»å½•é¡µ")&&_.push("/login"):alert(e.message||"æ·»åŠ åˆ°è´­ç‰©è½¦å¤±è´¥")}};return b(()=>{const o=m(u.query.q);o&&i.searchProducts(o)}),(o,t)=>(a(),n(y,null,[v(V),v(A),s("div",j,[C.value?(a(),n("div",D,[...t[0]||(t[0]=[s("div",{class:"spinner"},null,-1),s("p",null,"æ­£åœ¨æœç´¢...",-1)])])):l.value.length===0&&g.value?(a(),n("div",E,[t[2]||(t[2]=s("div",{class:"empty-icon"},"ğŸ”",-1)),s("h3",null,'æ²¡æœ‰æ‰¾åˆ°"'+c(g.value)+'"ç›¸å…³å•†å“',1),t[3]||(t[3]=s("p",null,"è¯·å°è¯•å…¶ä»–å…³é”®è¯",-1)),s("div",H,[t[1]||(t[1]=s("h4",null,"çƒ­é—¨æœç´¢ï¼š",-1)),s("div",I,[(a(!0),n(y,null,k(q.value,e=>(a(),n("span",{key:e,class:"hot-tag",onClick:p=>S(e)},c(e),9,W))),128))])])])):l.value.length>0?(a(),n("div",z,[s("div",G,[t[4]||(t[4]=s("h2",null,"æœç´¢ç»“æœ",-1)),s("p",J,"æ‰¾åˆ° "+c(l.value.length)+" ä¸ªç›¸å…³å•†å“",1)]),s("div",O,[(a(!0),n(y,null,k(l.value,e=>(a(),n("div",{key:e.id,class:"product-card"},[s("div",{class:"product-image-wrapper",onClick:p=>f(e.id)},[s("img",{src:e.picture,alt:e.name,class:"product-image"},null,8,X)],8,U),s("div",Y,[s("h3",{class:"product-name",onClick:p=>f(e.id)},c(e.name),9,Z),s("p",ss,c(e.desc),1),s("div",ts,"Â¥"+c(e.price.toFixed(2)),1),s("button",{class:"add-to-cart-btn",onClick:F(p=>L(e),["stop"])},"åŠ å…¥è´­ç‰©è½¦",8,es)])]))),128))])])):(a(),n("div",os,[...t[5]||(t[5]=[s("div",{class:"placeholder-icon"},"ğŸ”",-1),s("p",null,"è¯·è¾“å…¥å…³é”®è¯æœç´¢å•†å“",-1)])]))]),h.value?(a(),n("div",ns," âœ… å•†å“å·²æˆåŠŸæ·»åŠ åˆ°è´­ç‰©è½¦ï¼ ")):B("",!0),v(Q)],64))}}),ds=M(as,[["__scopeId","data-v-dd69176b"]]);export{ds as default};
