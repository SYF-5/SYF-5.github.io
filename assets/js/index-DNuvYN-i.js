import{d as J,r as p,o as N,b as X,f as c,g as e,l as E,F as y,q as w,k as i,s as F,e as P,j as H,i as Y,t as v,h as D,v as K,_ as U,c as R,x as V,u as z,y as Z,z as ee,A as se}from"./index-DsC-O0Dj.js";import{p as b}from"./productService-BHw07omx.js";const te={class:"home-category"},oe={class:"menu"},ne={key:0,class:"loading"},le={key:1,class:"empty"},ae=["onMouseenter"],ie=["onClick"],ce={key:0,class:"layer"},re=["onClick"],de={class:"image-container"},ue=["src","alt","onLoad","onError"],ge={key:0,class:"loading-placeholder"},_e={class:"info"},me={class:"name ellipsis-2"},ve={class:"desc ellipsis"},he={class:"price"},fe=J({__name:"HomeCategory",setup(G){const k=K(),u=p([]),h=p(!0),f=p(null),g=p({}),I=p(null);let C=null;const M=t=>{C&&(clearTimeout(C),C=null),I.value=t,u.value[t]&&d(u.value[t].id)},j=()=>{C=setTimeout(()=>{I.value=null},150)},B=async()=>{try{h.value=!0,f.value=null,console.log("å¼€å§‹èŽ·å–åˆ†ç±»æ•°æ®..."),await b.loadAllData();const t=b.getCategories();console.log("èŽ·å–åˆ°çš„åˆ†ç±»æ•°æ®:",t),t&&t.length>0?(u.value=t,console.log("æˆåŠŸè®¾ç½®åˆ†ç±»æ•°æ®:",u.value.length,"ä¸ªåˆ†ç±»"),u.value.length>0&&setTimeout(()=>{r()},1e3)):(console.warn("æ²¡æœ‰èŽ·å–åˆ°åˆ†ç±»æ•°æ®"),f.value="æš‚æ— åˆ†ç±»æ•°æ®")}catch(t){console.error("èŽ·å–åˆ†ç±»æ•°æ®å¤±è´¥:",t),f.value="æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"}finally{h.value=!1}},x={1:"/images/list-01.jpg",2:"/images/list-02.jpg",3:"/images/list-03.jpg",4:"/images/list-04.webp",5:"/images/list-05.jpg",6:"/images/list-06.jpg",7:"/images/list-07.webp",8:"/images/list-08.jpg",9:"/images/list-09.jpg",10:"/images/list-10.webp"},L=(t,l)=>{if(t&&typeof t=="string"){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("/"))return t;if(!t.startsWith("/"))return`/${t}`}if(l&&x[l])return x[l];if(l){const _=[1,2,3,4,5,6,7,8,9,10],a=(l-1)%_.length,m=_[a],n=x[m]?.endsWith(".webp")?".webp":".jpg";return`/images/list-${String(m).padStart(2,"0")}${n}`}return"/images/cx.svg"},S=(t,l)=>{const _=t.target;console.warn(`å•†å“ ${l} å›¾ç‰‡åŠ è½½å¤±è´¥: ${_.src}`),_.src="/images/cx.svg",g.value[l]===!1&&(g.value[l]=!0)},T=(t,l,_)=>{console.log(`ç‚¹å‡»äº† ${l} - ${_}`);const a=b.getGoodsByCategoryId(t);if(a&&a.length>0){const m=a[0];k.push(`/product/${m.id}`)}else alert("è¯¥åˆ†ç±»ä¸‹æš‚æ— å•†å“")},W=t=>{console.log(`ç‚¹å‡»äº†å•†å“ ID: ${t}`),k.push(`/product/${t}`)},q=t=>{g.value[t]=!0},o=t=>{const _=(b.getGoodsByCategoryId(t)||[]).slice(0,6);return _.forEach(a=>{g.value[a.id]||(g.value[a.id]=!1)}),_},d=t=>{const l=o(t);if(!l||l.length===0)return;l.slice(0,3).forEach(a=>{const m=L(a.picture,a.id);if(s(m))return;const n=new Image;n.src=m,n.onload=()=>{console.log(`é¢„åŠ è½½æˆåŠŸ: ${a.id}`),g.value[a.id]=!0},n.onerror=()=>{console.log(`é¢„åŠ è½½å¤±è´¥: ${a.id}`)}})},s=t=>{try{const l=new Image;return l.src=t,l.complete}catch{return!1}},r=()=>{"requestIdleCallback"in window?requestIdleCallback(()=>{u.value.length>0&&(console.log("ç©ºé—²æ—¶é—´é¢„åŠ è½½ç¬¬ä¸€ä¸ªåˆ†ç±»å›¾ç‰‡"),d(u.value[0].id))},{timeout:2e3}):setTimeout(()=>{u.value.length>0&&(console.log("å®šæ—¶å™¨é¢„åŠ è½½ç¬¬ä¸€ä¸ªåˆ†ç±»å›¾ç‰‡"),d(u.value[0].id))},2e3)},O=()=>{if("requestIdleCallback"in window){const t=l=>{const _=u.value.filter((m,n)=>n>0);let a=0;for(;l.timeRemaining()>0&&a<_.length;){const m=_[a],n=b.getGoodsByCategoryId(m.id)||[];if(n.length>0){const $=n[0],A=L($.picture,$.id);if(!s(A)){const Q=new Image;Q.src=A}}a++}a<_.length&&requestIdleCallback(t)};setTimeout(()=>{requestIdleCallback(t)},3e3)}};return N(()=>{console.log("ä¾§è¾¹åˆ—è¡¨ç»„ä»¶å·²æŒ‚è½½"),B().then(()=>{setTimeout(()=>{O()},3e3)})}),X(()=>{C&&clearTimeout(C)}),(t,l)=>{const _=Y("RouterLink");return i(),c("div",te,[e("ul",oe,[h.value?(i(),c("li",ne," åˆ†ç±»åŠ è½½ä¸­... ")):u.value.length===0?(i(),c("li",le," æš‚æ— åˆ†ç±»æ•°æ® ")):E("",!0),(i(!0),c(y,null,w(u.value,(a,m)=>(i(),c("li",{key:a.id,class:F({"is-active":I.value===m}),onMouseenter:n=>M(m),onMouseleave:j},[P(_,{to:"/category"},{default:H(()=>[D(v(a.name),1)]),_:2},1024),(i(!0),c(y,null,w(a.children,n=>(i(),c("a",{key:n,href:"javascript:;",onClick:$=>T(a.id,a.name,n),class:"sub-category-link"},v(n),9,ie))),128)),I.value===m?(i(),c("div",ce,[l[1]||(l[1]=e("h4",null,[D("åˆ†ç±»æŽ¨è "),e("small",null,"æ ¹æ®æ‚¨çš„è´­ä¹°æˆ–æµè§ˆè®°å½•æŽ¨è")],-1)),e("ul",null,[(i(!0),c(y,null,w(o(a.id),n=>(i(),c("li",{key:n.id},[e("a",{href:"javascript:;",onClick:$=>W(n.id),class:"product-link"},[e("div",de,[e("img",{src:L(n.picture,n.id),alt:n.name,onLoad:$=>q(n.id),onError:$=>S($,n.id)},null,40,ue),g.value[n.id]?E("",!0):(i(),c("div",ge))]),e("div",_e,[e("p",me,v(n.name),1),e("p",ve,v(n.desc),1),e("p",he,[l[0]||(l[0]=e("i",null,"Â¥",-1)),D(v(n.price?.toFixed(2)),1)])])],8,re)]))),128))])])):E("",!0)],42,ae))),128))])])}}}),pe=U(fe,[["__scopeId","data-v-f9669d6e"]]),ye={class:"home"},ke={class:"main-container"},Ce={class:"category-nav"},$e=["onClick"],be={class:"category-icon"},we={class:"category-name"},Ie={key:0,class:"loading-state"},xe={key:1,class:"error-state"},Le={class:"product-section"},Ee={class:"products-grid"},Pe=["onClick"],je={class:"product-image"},Be=["src","alt","onLoad","onError"],Te={key:0,class:"loading-placeholder"},We={class:"product-info"},Ge={class:"desc"},Me={class:"price"},Se=["onClick"],qe={class:"product-section"},De={class:"products-grid"},Fe=["onClick"],He={class:"product-image"},Ne=["src","alt","onLoad","onError"],Ue={key:0,class:"loading-placeholder"},Ae={class:"product-info"},Re={class:"desc"},Ve={class:"price"},ze=["onClick"],Je={__name:"HomeProduct",setup(G){const k=K(),u=p(!1),h=p(null),f=p([]),g=p({}),I=R(()=>f.value.slice(0,4)),C=R(()=>f.value.slice(4)),M=["è”¬èœ","æ°´æžœ","è‚‰ç±»","ç²®æ²¹","å¥¶åˆ¶å“","é›¶é£Ÿ"],j=(o,d)=>{if(!o||o.trim()==="")return"/images/cx.svg";const s=o.trim();if(s.startsWith("http://")||s.startsWith("https://"))return s;let r=s;return r.startsWith("./")&&(r=r.substring(2)),r.startsWith("/")||(r="/"+r),r.includes("/list-")&&!r.includes("list-01")&&!r.includes("list-02")&&!r.includes("list-03")?"/images/cx.svg":r},B=(o,d)=>{const s=o.target;console.warn(`å•†å“ ${d} å›¾ç‰‡åŠ è½½å¤±è´¥: ${s.src}`),s.src="/images/cx.svg",g.value[d]===!1&&(g.value[d]=!0)},x=o=>{g.value[o]=!0},L=async()=>{console.log("å¼€å§‹èŽ·å–å•†å“æ•°æ®..."),u.value=!0,h.value=null;try{await b.loadAllData();const o=b.getAllProducts();console.log("èŽ·å–åˆ°çš„çœŸå®žå•†å“:",o),o&&o.length>0?(f.value=o,o.forEach(d=>{g.value[d.id]=!1}),console.log("æˆåŠŸè®¾ç½®çœŸå®žå•†å“åˆ—è¡¨ï¼Œæ•°é‡:",o.length)):(h.value="æš‚æ— å•†å“æ•°æ®",console.log("æ²¡æœ‰èŽ·å–åˆ°å•†å“æ•°æ®"))}catch(o){console.error("èŽ·å–å•†å“å¤±è´¥:",o),h.value="æ•°æ®åŠ è½½å¤±è´¥: "+o.message}finally{u.value=!1}},S=o=>{console.log("ç‚¹å‡»åˆ†ç±»:",o)},T=o=>{console.log("è·³è½¬åˆ°å•†å“è¯¦æƒ…:",o.id),k.push(`/product/${o.id}`)},W=o=>{console.log("æ·»åŠ åˆ°è´­ç‰©è½¦:",o.name),alert(`å·²æ·»åŠ  ${o.name} åˆ°è´­ç‰©è½¦`)},q=o=>({è”¬èœ:"ðŸ¥¬",æ°´æžœ:"ðŸŽ",è‚‰ç±»:"ðŸ¥©",ç²®æ²¹:"ðŸš",å¥¶åˆ¶å“:"ðŸ¥›",é›¶é£Ÿ:"ðŸª"})[o]||"ðŸ›’";return N(()=>{console.log("é¦–é¡µç»„ä»¶æŒ‚è½½"),L()}),(o,d)=>(i(),c("div",ye,[d[3]||(d[3]=e("div",{class:"banner-container"},[e("div",{class:"banner"},[e("img",{src:"/src/assets/images/cx.jpg",alt:"å°å…”é²œä¿ƒé”€æ¨ªå¹…"})])],-1)),e("div",ke,[e("div",Ce,[(i(),c(y,null,w(M,s=>e("div",{class:"category-item",key:s,onClick:r=>S(s)},[e("span",be,v(q(s)),1),e("span",we,v(s),1)],8,$e)),64))]),u.value?(i(),c("div",Ie,[...d[0]||(d[0]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"å•†å“åŠ è½½ä¸­...",-1)])])):h.value?(i(),c("div",xe,[e("p",null,v(h.value),1),e("button",{onClick:L,class:"retry-btn"},"é‡è¯•")])):(i(),c(y,{key:2},[e("div",Le,[d[1]||(d[1]=e("h2",{class:"section-title"},"æ–°é²œå¥½ç‰©",-1)),e("div",Ee,[(i(!0),c(y,null,w(I.value,s=>(i(),c("div",{class:"product-item",key:s.id,onClick:r=>T(s)},[e("div",je,[e("img",{src:j(s.picture,s.id),alt:s.name,onLoad:()=>x(s.id),onError:r=>B(r,s.id),class:F({loaded:g.value[s.id]})},null,42,Be),g.value[s.id]?E("",!0):(i(),c("div",Te))]),e("div",We,[e("h3",null,v(s.name),1),e("p",Ge,v(s.desc||s.description),1),e("p",Me,"Â¥"+v(s.price?.toFixed(2)),1),e("button",{class:"add-cart-btn",onClick:V(r=>W(s),["stop"])},"åŠ å…¥è´­ç‰©è½¦",8,Se)])],8,Pe))),128))])]),e("div",qe,[d[2]||(d[2]=e("h2",{class:"section-title"},"çƒ­é—¨å•†å“",-1)),e("div",De,[(i(!0),c(y,null,w(C.value,s=>(i(),c("div",{class:"product-item",key:s.id,onClick:r=>T(s)},[e("div",He,[e("img",{src:j(s.picture,s.id),alt:s.name,onLoad:()=>x(s.id),onError:r=>B(r,s.id),class:F({loaded:g.value[s.id]})},null,42,Ne),g.value[s.id]?E("",!0):(i(),c("div",Ue))]),e("div",Ae,[e("h3",null,v(s.name),1),e("p",Re,v(s.desc||s.description),1),e("p",Ve,"Â¥"+v(s.price?.toFixed(2)),1),e("button",{class:"add-cart-btn",onClick:V(r=>W(s),["stop"])},"åŠ å…¥è´­ç‰©è½¦",8,ze)])],8,Fe))),128))])])],64))])]))}},Ke=U(Je,[["__scopeId","data-v-1a43c4e2"]]),Oe={class:"home-banner"},Qe=["src","alt"],Xe=J({__name:"HomeBanner",setup(G){const k=p([{picture:"./images/Banner-1.jpg",alt:"æµ‹è¯•å›¾ç‰‡1"},{picture:"./images/Banner-2.jpg",alt:"æµ‹è¯•å›¾ç‰‡2"},{picture:"https://syf-5.github.io/public/images/Banner-3.webp",alt:"æµ‹è¯•å›¾ç‰‡3"},{picture:"https://syf-5.github.io/dist/images/Banner-4.webp",alt:"æµ‹è¯•å›¾ç‰‡4"}]);return N(()=>{console.log("è½®æ’­å›¾æ•°æ®å·²åŠ è½½:",k.value)}),(u,h)=>(i(),c("div",Oe,[P(z(Z),{height:"500px",interval:4e3,"indicator-position":"outside"},{default:H(()=>[(i(!0),c(y,null,w(k.value,(f,g)=>(i(),ee(z(se),{key:g},{default:H(()=>[e("img",{src:f.picture,alt:f.alt||"Banner"},null,8,Qe)]),_:2},1024))),128))]),_:1})]))}}),Ye=U(Xe,[["__scopeId","data-v-5384d803"]]),Ze={class:"container"},ts={__name:"index",setup(G){return(k,u)=>(i(),c(y,null,[e("div",Ze,[P(pe),P(Ye)]),P(Ke)],64))}};export{ts as default};
